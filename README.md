# Python_DES_Decryptor
A simple python script for decrypting DES that has been generated by a .NET application

This came up in an engagement where a C# application contained a hard-coded key that was being used to store user credentials for remote access.  As a POC we reverse engineered the application to extract the key and IV used to store the passwords and created a simple Python script to decrypt these.

C# makes a few assumptions by default on the padding type (PKCS7) and the mode (CBC) which we need to account for in the Python code.
The C# code below also converts the cipher text to BASE64 to make it easier to store in an ASCII configuration file.

## Typical C# Code for Storing DES Encryption

```CSharp
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Security.Cryptography;
using System.Text;
using System.Threading.Tasks;

namespace DESCrypto
{
    class DESCrypto
    {
        static void Main()
        {
            byte[] key = Encoding.ASCII.GetBytes("s3cret12");
            byte[] iv = Encoding.ASCII.GetBytes("vector12");
            String plaintext = "encrypt me please!";
            DESCryptoServiceProvider dESCryptoServiceProvider = new DESCryptoServiceProvider();
            MemoryStream memoryStream = new MemoryStream();
            CryptoStream cryptoStream = new CryptoStream(memoryStream, dESCryptoServiceProvider.CreateEncryptor(key, iv), CryptoStreamMode.Write);
            StreamWriter streamWriter = new StreamWriter(cryptoStream);
            streamWriter.Write(plaintext);
            streamWriter.Flush();
            cryptoStream.FlushFinalBlock();
            streamWriter.Flush();
            Console.WriteLine(Convert.ToBase64String(memoryStream.GetBuffer(), 0, (int)memoryStream.Length));
            Console.WriteLine("Press any key to exit.");
            Console.ReadKey();
        }
    }
}


```

The Python Script DESCrypto.py is able to decrypt this C# DES encrypted string:


